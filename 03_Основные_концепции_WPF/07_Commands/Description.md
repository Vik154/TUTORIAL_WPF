### Концепция команд - *представляет собой механизм, упрощающий связывание задач, запросов и действий.* 

*Информация MSDN: https://learn.microsoft.com/ru-ru/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8* <br>

Команды WPF представляют собой подобные событиям сущности, которые независимы от конкретного элемента управления и во многих отношениях могут успешно применяться к многочисленным (и внешне несвязанным) типам элементов управления. Команды позволяют определять действия в одном месте, а затем ссылаться на них из всех элементов управления, таких как пункты меню, кнопки панели инструментов и т.п. <br>

Прямую реакцию приложения на определенные действия пользователя обычно называют задачами, а сами запросы на действия - командами. Команды используются для упрощения связывания задач, запросов и действий. Команды, как и события, в WPF являются маршрутизованными (Routed - направленный). Но здесь есть отличие: события могут туннелировать и всплывать, а команды только всплывают (команды бывают только пузырьковые, восходящие, всплывающие). На самом деле всплывают не сами команды, а генерируемые ими маршрутизованные события. <br>

WPF поддерживает команды Сору (Копировать), Paste (Вставить) и Cut (Вырезать), которые могут применяться к широкому разнообразию элементов пользовательского интерфейса (пунктам меню, кнопкам панели инструментов, специальным кнопкам) и могут использоваться в качестве альтернативы событиям, в результате получается более компактный и гибкий код. <br>

Модель перенаправляемых команд WPF можно разбить на четыре основных понятия: <br>
> *команда, источник команды, цель команды, привязка команды.* <br>

_Команда_ — это выполняемое действие. <br>
_Источник команды_ — это объект, который вызывает команду. <br>
_Цель команды_ — это объект, для которого выполняется команда.<br>
_Привязка команды_ — это объект, сопоставляющий логику команды с командой. <br>

Команды в WPF создаются путем реализации интерфейса System.Window.Input.ICommand: <br>
~~~C#
public interface ICommand {
  event EventHandler CanExecuteChanged;  // вызывается при изменении состояния команды 
  bool CanExecute(object parameter);     // возвращает true, если команда включена и доступна для использования, иначе false
  void Execute(object parameter);        // предназначен для хранения логики команды
}
~~~

Также существует стандартная реализация ICommand в виде классов RoutedCommand и RoutedUICommand: <br>
~~~C#
// Реализующий класс RoutedCommand расширяет сигнатуру объявленных в ICommand методов до второго аргумента target
public bool CanExecute(object parameter, IInputElement target);  // parameter содержит сведения о команде 
public void Execute(object parameter, IInputElement target);     // target - сведения о целевом элементе команды.
~~~

При возбуждении элемента-источника, к которому прикреплена команда (объект RoutedCommand), вызывается метод CanExecute(). Этот метод возбуждает туннельное событие PreviewCanExecute, которое начинает спускаться от корня визуального дерева элементов к источнику команды и собирает информацию с целевых элементов о возможности выполнения команды. Получив результаты опроса от события PreviewCanExecute метод CanExecute() возбуждает парное восходящее событие CanExecute с заданием оповестить целевые элементы принять состояние в зависимости от полученной информации от события PreviewCanExecute, а сам возвращает флаг возможности или невозможности выполнения команды.

Если метод CanExecute() вернул значение true, значит исполнение команды возможно и следом вызывается метод Execute(), который последовательно возбуждает парные события PreviewExecuted и Executed как указание выполнить команду во всех целевых элементах прикрепленными к ним обработчиками. Событие отмены выполнения CanExecuteChanged вызывается, если диспетчер команд, в котором централизованно выполняются командные операции, обнаруживает в источнике команды изменения, которые могут сделать недействительной команду, вызванную, но еще не выполненную в целевом элементе.

Библиотечные классы команд
Библиотека .NET Framework имеет множество готовых команд, наиболее часто встречающихся в приложениях. Команды представлены в пространствах имен System.Windows. Input и System.Windows. Documents следующими статическими классами:

ApplicationCommands
ComponentCommands
MediaCommands
NavigationCommands
EditingCommands
В каждом из приведенных классов команда объявлена как статическое свойство только для чтения типа RoutedUICommand (или RoutedCommand ), следовательно при использовании команды создавать экземпляр класса команды не нужно. Команды имеют имена, ассоциируемые с выполняемой задачей, например, Cut, Copy, New и т.д.



<img align="center" width="1200" src="img/Event1.png" alt="Пример работы данного кода"/>


